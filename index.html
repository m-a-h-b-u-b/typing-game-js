<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Typing Speed Game</title>
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8;--glass: rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#020617 0%, #071028 100%); color:#e6eef6}
    .app{width:920px; max-width:96%; background:var(--card); padding:28px; border-radius:14px; box-shadow:0 10px 30px rgba(2,6,23,0.6);}
    h1{margin:0 0 8px; font-size:20px}
    .meta{display:flex; gap:12px; align-items:center; margin-bottom:18px}
    .meta .stat{background:var(--glass); padding:10px 14px; border-radius:10px; color:var(--muted);} 
    .sentence{background:rgba(255,255,255,0.03); padding:18px; border-radius:10px; min-height:72px; font-size:18px; line-height:1.45; margin-bottom:14px}
    .sentence .correct{color:#9ae6b4}
    .sentence .wrong{color:#feb2b2; text-decoration:underline wavy}
    textarea.input{width:100%; min-height:100px; resize:none; padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:inherit; font-size:16px}
    .controls{display:flex; gap:10px; margin-top:12px; align-items:center}
    button{background:var(--accent); border:none; color:#042026; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600}
    select{background:transparent; border-radius:8px; padding:8px; color:inherit; border:1px solid rgba(255,255,255,0.04)}
    .results{display:flex; gap:12px; margin-top:14px}
    .results .card{background:var(--glass); padding:12px; border-radius:8px; min-width:120px; text-align:center}
    .small{font-size:12px; color:var(--muted)}
    footer{margin-top:14px; font-size:13px; color:var(--muted)}
    @media (max-width:560px){.meta{flex-direction:column; align-items:flex-start}}
  </style>
</head>
<body>
  <main class="app" role="main">
    <h1>Typing Speed Game — JavaScript</h1>
    <div class="meta">
      <div class="stat"><strong id="timer">0</strong> s</div>
      <div class="stat"><strong id="wpm">0</strong> WPM</div>
      <div class="stat"><strong id="accuracy">100</strong>% accuracy</div>
      <div style="margin-left:auto" class="small">Press <kbd>Ctrl</kbd>+<kbd>Enter</kbd> to submit</div>
    </div>

    <div id="sentence" class="sentence" aria-live="polite"></div>

    <textarea id="input" class="input" placeholder="Start typing here..." aria-label="Typing input"></textarea>

    <div class="controls">
      <label class="small">Mode:
        <select id="mode">
          <option value="time">30s Time Trial</option>
          <option value="words">10 Words Test</option>
        </select>
      </label>

      <label class="small">Difficulty:
        <select id="difficulty">
          <option value="easy">Easy</option>
          <option value="medium" selected>Medium</option>
          <option value="hard">Hard</option>
        </select>
      </label>

      <button id="start">Start</button>
      <button id="restart">Restart</button>

      <div style="margin-left:auto" class="small">Made with vanilla JS — editable</div>
    </div>

    <div class="results" aria-hidden="false">
      <div class="card"><div class="small">Characters</div><strong id="chars">0</strong></div>
      <div class="card"><div class="small">Words</div><strong id="words">0</strong></div>
      <div class="card"><div class="small">Correct</div><strong id="correct">0</strong></div>
      <div class="card"><div class="small">Wrong</div><strong id="wrong">0</strong></div>
    </div>

    <footer>Tip: The timer starts when you type the first character. Accuracy = correct characters / total typed.</footer>
  </main>

  <script>
    // Typing Speed Game (vanilla JS)
    const sentenceEl = document.getElementById('sentence');
    const inputEl = document.getElementById('input');
    const startBtn = document.getElementById('start');
    const restartBtn = document.getElementById('restart');
    const timerEl = document.getElementById('timer');
    const wpmEl = document.getElementById('wpm');
    const accuracyEl = document.getElementById('accuracy');
    const charsEl = document.getElementById('chars');
    const wordsEl = document.getElementById('words');
    const correctEl = document.getElementById('correct');
    const wrongEl = document.getElementById('wrong');

    const modeEl = document.getElementById('mode');
    const difficultyEl = document.getElementById('difficulty');

    let timer = null;
    let timeLeft = 30; // default
    let started = false;
    let startTime = 0;
    let targetText = '';

    const sentences = {
      easy: [
        'The quick brown fox jumps over the lazy dog.',
        'Coding is fun and helps you build cool things.',
        'Practice makes perfect.'
      ],
      medium: [
        'Typing quickly requires focus, rhythm, and consistent practice.',
        'JavaScript powers interactive experiences across the web, from games to apps.',
        'Good posture and steady breathing improve typing endurance.'
      ],
      hard: [
        'Asynchronous programming and closures are core concepts in modern JavaScript development.',
        'Optimization mostly matters when an algorithmic inefficiency shows up at scale.',
        'A well-structured test suite prevents regressions and encourages refactoring.'
      ]
    };

    function pickText() {
      const diff = difficultyEl.value;
      const list = sentences[diff];
      // If words mode, build a longer phrase of N words
      if (modeEl.value === 'words') {
        const needed = 10;
        const pool = list.join(' ').split(/\s+/);
        // random sample
        let out = [];
        for (let i = 0; i < needed; i++) out.push(pool[Math.floor(Math.random() * pool.length)]);
        return out.join(' ');
      }
      return list[Math.floor(Math.random() * list.length)];
    }

    function renderTarget(text) {
      sentenceEl.innerHTML = '';
      // Wrap each character in a span for per-char coloring
      for (const ch of text) {
        const span = document.createElement('span');
        span.textContent = ch;
        sentenceEl.appendChild(span);
      }
    }

    function resetStats() {
      timerEl.textContent = '0';
      wpmEl.textContent = '0';
      accuracyEl.textContent = '100';
      charsEl.textContent = '0';
      wordsEl.textContent = '0';
      correctEl.textContent = '0';
      wrongEl.textContent = '0';
      inputEl.value = '';
      started = false;
      clearInterval(timer);
      timer = null;
    }

    function startGame() {
      resetStats();
      // set timer based on mode
      if (modeEl.value === 'time') timeLeft = 30; else timeLeft = 9999; // words mode will stop on completion
      timerEl.textContent = timeLeft;
      targetText = pickText();
      renderTarget(targetText);
      inputEl.focus();
    }

    function endGame() {
      clearInterval(timer);
      timer = null;
      started = false;
      // compute final results (already updated live but ensure final)
      // show a gentle highlight
      sentenceEl.querySelectorAll('span').forEach(s => s.style.opacity = '0.95');
    }

    function updateStats() {
      const typed = inputEl.value;
      const typedChars = typed.length;
      let correct = 0;
      const spans = sentenceEl.querySelectorAll('span');
      for (let i = 0; i < spans.length; i++) {
        const expected = spans[i].textContent;
        const actual = typed[i];
        spans[i].className = '';
        if (actual == null) { /* not typed yet */ }
        else if (actual === expected) { spans[i].classList.add('correct'); correct++; }
        else { spans[i].classList.add('wrong'); }
      }
      const wrong = Math.max(0, typedChars - correct);
      const words = typed.trim().length ? typed.trim().split(/\s+/).length : 0;

      charsEl.textContent = typedChars;
      wordsEl.textContent = words;
      correctEl.textContent = correct;
      wrongEl.textContent = wrong;

      const elapsedSecs = (Date.now() - startTime) / 1000 || 1;
      const minutes = elapsedSecs / 60;
      const wpm = Math.round((words / (minutes || 1)) || 0);
      const accuracy = typedChars ? Math.round((correct / typedChars) * 100) : 100;

      wpmEl.textContent = isFinite(wpm) ? wpm : 0;
      accuracyEl.textContent = accuracy;

      // stop conditions
      if (modeEl.value === 'words' && words >= 10) {
        endGame();
      }
    }

    // Timer tick for time mode
    function tick() {
      if (timeLeft <= 0) { endGame(); return; }
      timeLeft -= 1;
      timerEl.textContent = timeLeft;
      if (timeLeft <= 0) endGame();
    }

    // Events
    startBtn.addEventListener('click', () => {
      startGame();
      // start timer only on first keypress
    });

    restartBtn.addEventListener('click', () => startGame());

    // Start timer on first key press
    inputEl.addEventListener('keydown', (e) => {
      if (!started) {
        started = true;
        startTime = Date.now();
        if (modeEl.value === 'time') {
          // init full timer and then tick each second
          timerEl.textContent = timeLeft;
          timer = setInterval(tick, 1000);
        }
      }
      // Ctrl+Enter to finish quickly
      if (e.ctrlKey && e.key === 'Enter') {
        endGame();
      }
    });

    inputEl.addEventListener('input', () => updateStats());

    // Initialize for first load
    (function init(){
      targetText = pickText();
      renderTarget(targetText);
      resetStats();
    })();

    // Accessibility: allow clicking the sentence to focus input
    sentenceEl.addEventListener('click', () => inputEl.focus());
  </script>
</body>
</html>
